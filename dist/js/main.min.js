"use strict";function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,r=Object(this),o=r.length>>>0,n=arguments[1],a=0;a<o;a++)if(t=r[a],e.call(n,t,a,r))return t}),function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,e.closest=e.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null}}(Element.prototype),function(){var e=[window.Element,window.CharacterData,window.DocumentType],t=[];e.forEach(function(e){e&&t.push(e.prototype)}),t.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}();var hospitals=[],persisted=localStorage.getItem("hospitals");persisted&&(hospitals=JSON.parse(persisted)),window.onload=function(){persisted&&0<hospitals.length&&createPersistedTable(),addButtonClickHandler(),deleteHospital(),editHospital()};var createId=function(){return"f".concat((~~(1e8*Math.random())).toString(16))},createItemControls=function(){var r=document.createElement("div");return r.className="table-item__controls",[{title:"Удалить",class:"delete"},{title:"Редактировать",class:"edit"}].forEach(function(e){var t=document.createElement("button");t.className=e.class,t.innerHTML=e.title,t.type="button",r.appendChild(t)}),r},createPersistedTable=function(){var e=document.querySelector(".no-data"),t=document.querySelector(".table");e.remove(),hospitals.forEach(function(r){var o=document.createElement("div"),e=createItemControls();o.className="table-item",o.appendChild(e),o.setAttribute("data-id",r.id),Object.keys(r).forEach(function(e){if("id"!==e){var t=document.createElement("div");t.innerHTML=r[e],o.appendChild(t)}}),t.appendChild(o)})},modalCloseHandler=function(){document.querySelector(".modal").classList.remove("modal_active")},modalOpenHandler=function(e){var t=document.querySelector(".modal"),r=document.querySelector(".modal-close"),o=document.querySelector("form"),n=document.querySelector(".modal-submit");e||"Добавить"===n.innerHTML||(n.innerHTML="Добавить"),e&&"edit"===e&&"Изменить"!==n.innerHTML&&(n.innerHTML="Изменить"),r.onclick=function(e){e.preventDefault(),modalCloseHandler(),o.reset()},t.classList.add("modal_active")},addButtonClickHandler=function(){document.querySelector(".button-add").onclick=function(){modalOpenHandler(),addHospital()}},addHospital=function(){document.querySelector(".modal-submit").onclick=function(e){var t={},r=document.querySelector("form"),o=document.querySelectorAll("input");o=Array.prototype.slice.call(o);var n=document.querySelector(".table"),a=document.querySelector(".no-data"),l=!1,i=createId();if(e.preventDefault(),o.forEach(function(e){e.value.length<1?l=!0:t[e.name]=e.value}),t.id=i,l)l=!1;else{hospitals.push(t);var c=JSON.stringify(hospitals);localStorage.setItem("hospitals",c);var s=document.createElement("div"),d=createItemControls();s.className="table-item",s.setAttribute("data-id",i),o.forEach(function(e){var t=document.createElement("div");t.innerHTML=e.value,s.appendChild(t)}),a&&a.remove(),s.appendChild(d),n.appendChild(s),r.reset(),modalCloseHandler(),deleteHospital(),editHospital()}}},deleteHospital=function(){Array.prototype.slice.call(document.querySelectorAll(".delete")).forEach(function(e){e.onclick=function(){var e=this.closest(".table-item"),t=e.getAttribute("data-id");hospitals=hospitals.filter(function(e){return e.id!==t});var r=JSON.stringify(hospitals);localStorage.setItem("hospitals",r),e.remove(),hospitals.length<1&&renderNoData()}})},renderNoData=function(){var e=document.querySelector(".table"),t=document.createElement("div");t.className="no-data",t.innerHTML="Нет данных",e.appendChild(t)},editHospital=function(){Array.prototype.slice.call(document.querySelectorAll(".edit")).forEach(function(e){e.onclick=function(){var e=document.querySelector(".modal-submit"),o=Array.prototype.slice.call(document.querySelectorAll("input")),n=this.closest(".table-item"),a=document.querySelector("form"),l=!1,i=n.getAttribute("data-id"),t=hospitals.find(function(e){return e.id===i});o[0].value=t.full_name,o[1].value=t.address,o[2].value=t.phone,modalOpenHandler("edit"),e.onclick=function(e){if(e.preventDefault(),o.forEach(function(e){e.value.length<1&&(l=!0)}),l)l=!1;else{hospitals=hospitals.map(function(e){return e.id===i?_objectSpread({},e,{full_name:o[0].value,address:o[1].value,phone:o[2].value}):_objectSpread({},e)});var t=JSON.stringify(hospitals);localStorage.setItem("hospitals",t);var r=n.querySelectorAll("div");(r=(r=Array.prototype.slice.call(r)).filter(function(e){return!e.classList.contains("table-item__controls")})).forEach(function(e,t){e.innerHTML=o[t].value}),modalCloseHandler(),a.reset()}}}})};